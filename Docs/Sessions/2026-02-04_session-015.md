# Session 2026-02-04 - session-015 (Seeding: Full Demo Data + Idempotency)

## Goals
- Implement mandatory seed script per PRD
- Ensure idempotent execution

## Context
- No Admin UI means all demo data must be created via script (Auth + Firestore), all emails @EMG.ma, include Amine Oukhouya

## Atomic Tasks
1) Create /seed folder with package.json and README -- DONE:
   - package.json with firebase-admin ^13.0.0, ES modules
   - README.md with setup instructions, data overview, verification

2) Implement seed.js using Firebase Admin SDK -- DONE:
   - Classes: GI (Génie Informatique), GE (Génie Électrique), GC (Génie Civil)
   - 6 subjects per class: Math, Physique, Informatique, Anglais, Communication, Spécialité
   - 11 teachers (shared across classes for common subjects, dedicated for specialty)
   - 25 students per class (75 total)
   - Timetable: 15 slots/week per class (Mon-Fri, 3 slots/day)
   - Sample assessments: 2 per class for current week

3) Create Auth users for all seeded accounts -- DONE:
   - getOrCreateUser(): creates Firebase Auth user if not exists
   - Default password: StudyPlanner2026!
   - Email format: firstname.lastname@EMG.ma
   - emailVerified: true

4) Ensure idempotency -- DONE:
   - Auth: getUserByEmail first, create only if not found
   - Firestore: set with { merge: true } for all documents
   - Deterministic IDs: classId_dayOfWeek_startMinute for slots, classId_subjectId_date for assessments

5) Print verification counts -- DONE:
   - Total users (students vs teachers)
   - Per-class: subjects, students, teachers, timetable slots, assessments

## Tests
- flutter analyze: 0 issues
- flutter test: 1 test passed
- npm install: OK (163 packages)

## Errors
- None (firebase-admin has 3 high severity vulnerabilities in dependencies, but these are in firebase-admin itself and cannot be easily fixed)

## Outputs
Files created:
- seed/package.json (firebase-admin dependency, ES modules)
- seed/README.md (setup instructions, data overview)
- seed/seed.js (main seed script with idempotent upserts)

## Data Summary

### Classes (3)
| ID | Name |
|----|------|
| GI | Génie Informatique |
| GE | Génie Électrique |
| GC | Génie Civil |

### Teachers (11)
| Subject | Teacher(s) | Classes |
|---------|------------|---------|
| Math | Ahmed Benali, Fatima Zahrani | GI+GE, GC |
| Physique | Mohammed Idrissi, Khadija Amrani | GI+GE, GC |
| Informatique | Youssef Tazi, Samira Bouazza | GI+GE, GC |
| Anglais | Rachid Fassi | All |
| Communication | Nadia Chraibi | All |
| Spécialité GI | Omar Kettani | GI |
| Spécialité GE | Hassan Berrada | GE |
| Spécialité GC | Laila Filali | GC |

### Special Account
- **Amine Oukhouya** (amine.oukhouya@EMG.ma) - Student in GI class

## Next Steps
- Session-016: Notifications (FCM) + deployment + QA
